---
/** Server-rendered dynamic route (no getStaticPaths needed) */
export const prerender = false;

import Base from '../../layouts/Base.astro';
import Header from '../../components/Header.astro';
import ImageModal from '../../components/ImageModal.astro';
import type { Project } from '../../data/projects';
import { projects } from '../../data/projects';

const { slug } = Astro.params;
const project: Project | undefined = projects.find((p) => p.slug === slug);

if (!project) {
  // Clean 404 instead of 500 if slug not found
  return new Response('Not found', { status: 404 });
}

const { title, tag, images = [], blurb } = project;
---

<Base title={`${title} â€” Jeremey Burch`}>
  <Header />

  <section class="mx-auto max-w-7xl px-6 py-10">
    <div class="mb-6">
      <div class="text-xs tracking-widest text-white/60">{tag}</div>
      <h1 class="font-heading text-4xl">{title}</h1>
      {blurb && <p class="text-white/80 mt-3">{blurb}</p>}
    </div>

    <div class="grid gap-6 md:grid-cols-2">
      {images.map((src) => (
        <img
          src={src}
          alt={title}
          class="w-full rounded-xl border border-white/5 object-cover"
          data-zoom
          data-src={src}
        />
      ))}
    </div>
  </section>

  <ImageModal />
</Base>
